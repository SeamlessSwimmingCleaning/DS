<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=320, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* PDA THEME */
        :root { --bg: #d4d4d4; --ink: #1a1a1a; --border: 2px solid #1a1a1a; }

        /* THE FIX: No fixed position. Just a tall, unscrollable block. */
        body, html {
            margin: 0; padding: 226;
            width: 320px;
            height: 452px; /* Top (212) + Bottom (240) */
            background: #000;
            font-family: "Courier New", monospace;
            overflow: hidden; /* This stops the scrollbar */
        }

        #pda-shell {
            width: 320px;
            height: 452px;
            background: var(--bg);
        }

        /* TOP AREA */
        .display {
            width: 320px; height: 212px;
            background: var(--bg);
            border-bottom: 4px double var(--ink);
            box-sizing: border-box; padding: 10px;
        }

        /* BOTTOM AREA */
        .digitizer {
            width: 320px; height: 240px;
            background: var(--bg);
            box-sizing: border-box; padding: 10px;
        }

        /* APPS & UI */
        .win { display: none; height: 150px; border: 1px solid var(--ink); background: #eee; padding: 5px; font-size: 10px; }
        .active { display: block; }
        .taskbar { display: table; width: 100%; border-spacing: 2px; }
        .app-btn {
            display: table-cell; background: var(--bg); border: var(--border);
            font-size: 8px; text-align: center; height: 25px; vertical-align: middle; font-weight: bold;
        }
        .pad-btn { display: inline-block; width: 40px; height: 30px; background: var(--bg); border: var(--border); font-size: 10px; }
        
        #memo-list { padding: 0; list-style: none; margin: 0; height: 120px; overflow-y: scroll; }
        .memo-item { border-bottom: 1px solid var(--ink); padding: 2px 0; }
    </style>
</head>
<body scroll="no">

<div id="pda-shell">
    <div class="display">
        <div style="font-size: 9px; font-weight: bold; margin-bottom: 4px; border-bottom: 1px solid var(--ink);">E-INK PDA v2.0</div>
        
        <div id="w_memo" class="win active">
            <b>MEMO_STORAGE:</b>
            <ul id="memo-list"><li>- SYSTEM LOADED</li></ul>
        </div>

        <div id="w1" class="win"><div id="out">TERMINAL READY...</div></div>
        <div id="w2" class="win"><canvas id="snk" width="160" height="100"></canvas></div>
        <div id="w4" class="win"><canvas id="draw" width="280" height="130"></canvas></div>
    </div>

    <div class="digitizer">
        <div class="taskbar">
            <div class="app-btn" onclick="nav('w_memo')">MEMO</div>
            <div class="app-btn" onclick="nav('w1')">TERM</div>
            <div class="app-btn" onclick="nav('w2')">GAME</div>
            <div class="app-btn" onclick="nav('w4')">SKTCH</div>
        </div>

        <div style="text-align:center; margin-top: 15px;">
            <button class="pad-btn" onclick="mv(0,-1)">UP</button><br>
            <button class="pad-btn" onclick="mv(-1,0)">L</button>
            <button class="pad-btn" style="width:60px;" onclick="saveMemo()">SAVE</button>
            <button class="pad-btn" onclick="mv(1,0)">R</button><br>
            <button class="pad-btn" onclick="mv(0,1)">DN</button>
        </div>

        <input type="text" id="kb" placeholder="WRITE DATA..." style="width:90%; margin:15px 5% 0 5%; border:1px solid #000; background:transparent;">
    </div>
</div>

<script>
    /* --- NEW ADDITION: THE STATIC SNAP --- */
    
    // This tells the browser to never allow the user to drag the page
    document.addEventListener('touchmove', function(e) {
        // If we are NOT drawing, kill the scroll
        if (e.target.id !== 'draw') {
            e.preventDefault();
        }
    }, { passive: false });

    // If the 3DS browser shifts (like when the keyboard pops up), snap back
    function snap() {
        if (window.scrollY !== 0) {
            window.scrollTo(0, 0);
        }
    }
    setInterval(snap, 300);

    /* --- PDA LOGIC --- */
    var cur = 'w_memo';
    function nav(id) {
        document.getElementById(cur).classList.remove('active');
        document.getElementById(id).classList.add('active');
        cur = id;
    }

    function saveMemo() {
        var val = document.getElementById('kb').value;
        if(val) {
            var li = document.createElement('li');
            li.className = 'memo-item';
            li.innerHTML = "> " + val;
            document.getElementById('memo-list').appendChild(li);
            document.getElementById('kb').value = "";
            nav('w_memo');
        }
    }
    
    // Basic Snake/Sketch placeholders to keep buttons working
    function mv(x,y){ /* snake logic here */ }
</script>
</body>
</html>
