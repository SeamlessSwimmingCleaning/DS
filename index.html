<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=320, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* E-INK PALETTE: Strictly Monochrome */
        :root {
            --bg: #d4d4d4;    /* Classic E-ink Grey */
            --ink: #1a1a1a;   /* Dark Ink */
            --border: 2px solid #1a1a1a;
        }

        /* LOCKING THE VIEWPORT */
        html, body {
            margin: 0; padding: 0;
            width: 320px; height: 452px;
            overflow: hidden;
            background: #000;
            font-family: "Courier New", monospace;
            touch-action: none;
            -webkit-user-select: none;
        }

        #pda-shell {
            width: 320px;
            height: 452px;
            background: var(--bg);
            position: absolute;
            top: 0; left: 0;
        }

        /* TOP SCREEN (The Display) */
        .display {
            width: 320px;
            height: 212px;
            border-bottom: 4px double var(--ink);
            box-sizing: border-box;
            padding: 10px;
            position: relative;
        }

        /* BOTTOM SCREEN (The Input) */
        .digitizer {
            width: 320px;
            height: 240px;
            box-sizing: border-box;
            padding: 5px;
        }

        /* PDA COMPONENTS */
        .win { display: none; height: 160px; overflow: hidden; border: 1px solid var(--ink); background: #eee; padding: 5px; }
        .active { display: block; }

        .taskbar {
            display: table; width: 100%; border-spacing: 2px;
        }
        .app-btn {
            display: table-cell; background: var(--bg); border: var(--border);
            font-size: 9px; text-align: center; height: 30px; vertical-align: middle;
            font-weight: bold; cursor: pointer;
        }
        .app-btn:active { background: var(--ink); color: var(--bg); }

        .d-pad { text-align: center; margin-top: 5px; }
        .pad-btn {
            display: inline-block; width: 45px; height: 35px; 
            background: var(--bg); border: var(--border); font-weight: bold;
        }

        canvas { background: #fff; border: 1px solid var(--ink); display: block; margin: 0 auto; image-rendering: pixelated; }

        #flash-overlay {
            position: fixed; top: 0; left: 0; width: 320px; height: 452px;
            background: #000; opacity: 0; pointer-events: none; z-index: 100;
        }
    </style>
</head>
<body scroll="no">

<div id="flash-overlay"></div>

<div id="pda-shell">
    <div class="display">
        <div style="font-size: 10px; border-bottom: 1px solid var(--ink); margin-bottom: 5px;">PDA_OS v1.0 | SYSTEM_READY</div>
        
        <div id="w1" class="win active">
            <div id="out">LOG: Waiting for input...</div>
        </div>

        <div id="w2" class="win">
            <canvas id="snk" width="160" height="100"></canvas>
            <div id="score" style="font-size: 10px; text-align: center;">PTS: 0 | HI: 0</div>
        </div>

        <div id="w3" class="win" style="text-align:center;">
            <div style="font-size: 20px; margin-top: 20px;" id="clicks">0</div>
            <div style="width:20px; height:20px; border:2px solid #000; margin:10px auto;"></div>
        </div>

        <div id="w4" class="win">
            <canvas id="draw" width="280" height="140"></canvas>
        </div>

        <div id="w5" class="win" style="text-align:center;">
            <div id="m-stat" style="margin-top:40px; border:1px solid #000;">IDLE</div>
        </div>
    </div>

    <div class="digitizer">
        <div class="taskbar">
            <div class="app-btn" onclick="nav('w1')">MEMO</div>
            <div class="app-btn" onclick="nav('w2')">GAME</div>
            <div class="app-btn" onclick="nav('w3')">CNTR</div>
            <div class="app-btn" onclick="nav('w4')">SKTCH</div>
            <div class="app-btn" onclick="nav('w5')">MUSC</div>
        </div>

        <div class="d-pad">
            <button class="pad-btn" onclick="mv(0,-1)">UP</button><br>
            <button class="pad-btn" onclick="mv(-1,0)">L</button>
            <button class="pad-btn" style="width:70px;" onclick="exe()">EXEC</button>
            <button class="pad-btn" onclick="mv(1,0)">R</button><br>
            <button class="pad-btn" onclick="mv(0,1)">DOWN</button>
        </div>

        <input type="text" id="kb" oninput="upd()" style="width:90%; margin:10px 5%; border:1px solid #000; background:transparent;">
    </div>
</div>

<script>
    // PREVENT ALL SCROLLING
    document.addEventListener('touchmove', function(e) { if(e.target.id !== 'draw') e.preventDefault(); }, {passive:false});
    window.onscroll = function() { window.scrollTo(0,0); };

    var cur = 'w1', pts = 0, hi = 0;

    function nav(id) {
        // E-INK FLASH
        var f = document.getElementById('flash-overlay');
        f.style.opacity = 1; setTimeout(function(){ f.style.opacity = 0; }, 100);

        document.getElementById(cur).classList.remove('active');
        document.getElementById(id).classList.add('active');
        cur = id;
        if(id === 'w2') startSnk();
        if(id === 'w4') startDraw();
    }

    function upd() { document.getElementById('out').innerHTML = document.getElementById('kb').value; }
    
    function exe() { 
        if(cur === 'w3') { pts++; document.getElementById('clicks').innerHTML = pts; }
    }

    // DRAWING
    var dC = document.getElementById('draw'), dX = dC.getContext('2d'), dwn = false;
    function startDraw() {
        dC.ontouchstart = function() { dwn = true; dX.beginPath(); };
        dC.ontouchmove = function(e) {
            if(!dwn) return;
            var t = e.touches[0], r = dC.getBoundingClientRect();
            dX.lineTo(t.clientX - r.left, t.clientY - r.top); dX.stroke();
        };
        dC.ontouchend = function() { dwn = false; };
    }

    // SNAKE
    var sC = document.getElementById('snk'), sX = sC.getContext('2d');
    var sn, fd, vx, vy, loop;
    function mv(x,y) { vx=x; vy=y; }
    function startSnk() {
        if(loop) clearInterval(loop);
        sn = [{x:8,y:5}]; fd = {x:12,y:5}; vx=1; vy=0;
        loop = setInterval(function() {
            var h = {x: sn[0].x+vx, y: sn[0].y+vy};
            if(h.x<0||h.x>=20||h.y<0||h.y>=12.5) { startSnk(); return; }
            sn.unshift(h);
            if(h.x==fd.x && h.y==fd.y) {
                fd = {x: Math.floor(Math.random()*19), y: Math.floor(Math.random()*11)};
                document.getElementById('score').innerHTML = "PTS: " + (sn.length-1);
            } else { sn.pop(); }
            sX.fillStyle="#fff"; sX.fillRect(0,0,160,100);
            sX.fillStyle="#000"; for(var i=0;i<sn.length;i++) sX.fillRect(sn[i].x*8,sn[i].y*8,7,7);
            sX.strokeRect(fd.x*8,fd.y*8,7,7);
        }, 200);
    }
</script>
</body>
</html>
