<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=320, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        /* PDA THEME */
        :root { --bg: #d4d4d4; --ink: #1a1a1a; --border: 2px solid #1a1a1a; }

        /* THE LOCK: We force the body to be the exact height of the 3DS layout */
        body, html {
            margin: 0; padding: 0;
            width: 320px;
            height: 452px; 
            background: #000;
            font-family: "Courier New", monospace;
            overflow: hidden; /* Stops accidental scrolling */
        }

        /* Container that holds both screens */
        #pda-shell {
            width: 320px;
            height: 452px;
            background: var(--bg);
            display: block;
        }

        /* TOP SCREEN: Hardware height is approx 212px in browser */
        .display {
            width: 320px; 
            height: 212px;
            background: var(--bg);
            border-bottom: 4px double var(--ink);
            box-sizing: border-box; 
            padding: 10px;
        }

        /* BOTTOM SCREEN: Hardware height 240px */
        .digitizer {
            width: 320px; 
            height: 240px;
            background: var(--bg);
            box-sizing: border-box; 
            padding: 10px;
            border-top: 1px solid var(--ink); /* Visual gap for the hinge */
        }

        /* APPS */
        .win { display: none; height: 145px; border: 1px solid var(--ink); background: #eee; padding: 5px; font-size: 10px; }
        .active { display: block; }
        .taskbar { display: table; width: 100%; border-spacing: 2px; }
        .app-btn {
            display: table-cell; background: var(--bg); border: var(--border);
            font-size: 8px; text-align: center; height: 25px; vertical-align: middle; font-weight: bold;
        }
        .pad-btn { display: inline-block; width: 40px; height: 30px; background: var(--bg); border: var(--border); font-size: 10px; }
        
        #memo-list { padding: 0; list-style: none; margin: 0; height: 110px; overflow-y: auto; }
        .memo-item { border-bottom: 1px solid var(--ink); padding: 2px 0; font-size: 9px; }
    </style>
</head>
<body scroll="no">

<div id="pda-shell">
    <div class="display">
        <div style="font-size: 9px; font-weight: bold; border-bottom: 1px solid var(--ink);">PDA_OS_v3.0</div>
        
        <div id="w_memo" class="win active">
            <b>MEMO_LOG:</b>
            <ul id="memo-list"><li>- SYSTEM_READY</li></ul>
        </div>

        <div id="w1" class="win"><div id="out">TERMINAL...</div></div>
        <div id="w2" class="win"><canvas id="snk" width="160" height="100"></canvas></div>
        <div id="w4" class="win"><canvas id="draw" width="280" height="120"></canvas></div>
    </div>

    <div class="digitizer">
        <div class="taskbar">
            <div class="app-btn" onclick="nav('w_memo')">MEMO</div>
            <div class="app-btn" onclick="nav('w1')">TERM</div>
            <div class="app-btn" onclick="nav('w2')">GAME</div>
            <div class="app-btn" onclick="nav('w4')">SKTCH</div>
        </div>

        <div style="text-align:center; margin-top: 10px;">
            <button class="pad-btn" onclick="mv(0,-1)">UP</button><br>
            <button class="pad-btn" onclick="mv(-1,0)">L</button>
            <button class="pad-btn" style="width:60px;" onclick="saveMemo()">SAVE</button>
            <button class="pad-btn" onclick="mv(1,0)">R</button><br>
            <button class="pad-btn" onclick="mv(0,1)">DN</button>
        </div>

        <input type="text" id="kb" placeholder="DATA_ENTRY..." style="width:90%; margin:10px 5% 0 5%; border:1px solid #000; background:transparent;">
    </div>
</div>

<script>
    /* --- THE LOCK AND BRIDGE ADDITION --- */
    
    // This blocks the stylus from dragging the page around
    document.addEventListener('touchmove', function(e) {
        if (e.target.id !== 'draw' && e.target.id !== 'memo-list') {
            e.preventDefault();
        }
    }, { passive: false });

    // This ensures that when the page loads, it is centered exactly between screens
    function alignScreens() {
        window.scrollTo(0, 0);
    }
    
    // Run alignment immediately and every time a button is clicked
    window.onload = alignScreens;
    setInterval(alignScreens, 500);

    /* --- PDA FUNCTIONS --- */
    var cur = 'w_memo';
    function nav(id) {
        document.getElementById(cur).classList.remove('active');
        document.getElementById(id).classList.add('active');
        cur = id;
        alignScreens(); // Re-lock view on app switch
    }

    function saveMemo() {
        var val = document.getElementById('kb').value;
        if(val) {
            var li = document.createElement('li');
            li.className = 'memo-item';
            li.innerHTML = "> " + val;
            document.getElementById('memo-list').appendChild(li);
            document.getElementById('kb').value = "";
            nav('w_memo');
        }
    }
</script>
</body>
</html>
