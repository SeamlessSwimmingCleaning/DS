<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        :root {
            --bg-top: #fdfcf0; /* Warm Pastel Cream */
            --bg-bottom: #e8f4f8; /* Soft Pastel Blue */
            --border: #7d6e83; /* Muted Purple Border */
            --accent: #ffdfba; /* Pastel Orange Buttons */
            --text: #4a4a4a;
        }

        /* HARD LOCK: Prevents scrolling on 3DS */
        body, html {
            margin: 0; padding: 0;
            width: 100vw; height: 100vh;
            overflow: hidden;
            font-family: 'Courier New', monospace;
            background: #222;
            image-rendering: pixelated;
        }

        /* Top Screen Area (400x240) */
        .top-screen {
            position: fixed; top: 0; left: 0;
            width: 400px; height: 240px;
            background: var(--bg-top);
            border-bottom: 4px solid var(--border);
            box-sizing: border-box;
            padding: 10px;
        }

        /* Bottom Screen Area (320x240) */
        .bottom-screen {
            position: fixed; top: 240px; left: 40px; /* Offset to center slightly on 3DS */
            width: 320px; height: 240px;
            background: var(--bg-bottom);
            border: 4px solid var(--border);
            box-sizing: border-box;
        }

        /* App Windows on Top Screen */
        .app-window {
            display: none;
            width: 100%; height: 100%;
            border: 2px solid var(--border);
            background: #fff;
            padding: 5px;
            box-sizing: border-box;
        }

        .active-app { display: block; }

        /* Keypad Styling */
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 10px;
            height: 100%;
        }

        .btn {
            background: var(--accent);
            border: 3px solid var(--border);
            text-align: center;
            line-height: 50px;
            font-weight: bold;
            color: var(--text);
            cursor: pointer;
            text-transform: uppercase;
        }

        .btn:active { background: white; }

        /* Pixel Game Canvas */
        canvas {
            background: #000;
            display: block;
            margin: 0 auto;
            border: 2px solid var(--border);
        }

    </style>
</head>
<body scroll="no">

<div class="top-screen">
    <div id="editor" class="app-window active-app">
        <div style="font-size:10px; border-bottom:1px solid #ccc; margin-bottom:5px;">NOTES.TXT</div>
        <div id="editorText" style="white-space: pre-wrap;">Welcome to Pastel-OS. Use the bottom keyboard to type.</div>
    </div>

    <div id="snake" class="app-window">
        <canvas id="snakeCanvas" width="160" height="120"></canvas>
        <div id="snakeScore" style="font-size:12px; text-align:center;">Score: 0</div>
    </div>

    <div id="clicker" class="app-window" style="text-align:center;">
        <h2 id="cookies">0 Points</h2>
        <div style="width:50px; height:50px; background:var(--accent); margin:10px auto; border:3px solid var(--border);"></div>
        <p style="font-size:10px;">Tap 'TAP' on bottom screen!</p>
    </div>
</div>

<div class="bottom-screen">
    <div class="keypad">
        <div class="btn" onclick="openApp('editor')">Text</div>
        <div class="btn" onclick="openApp('snake')">Snake</div>
        <div class="btn" onclick="openApp('clicker')">Clicker</div>
        
        <div class="btn" onclick="snakeDir('up')">UP</div>
        <div class="btn" onclick="snakeDir('down')">DOWN</div>
        <div class="btn" onclick="doAction()">TAP</div>
        
        <div class="btn" onclick="snakeDir('left')">LEFT</div>
        <div class="btn" onclick="snakeDir('right')">RIGHT</div>
        <div class="btn" onclick="location.reload()">OFF</div>
    </div>
</div>

<script>
    let currentApp = 'editor';
    let cookieCount = 0;

    function openApp(id) {
        document.querySelectorAll('.app-window').forEach(app => app.classList.remove('active-app'));
        document.getElementById(id).classList.add('active-app');
        currentApp = id;
        if(id === 'snake') startSnake();
    }

    // CLICKER LOGIC
    function doAction() {
        if(currentApp === 'clicker') {
            cookieCount++;
            document.getElementById('cookies').innerText = cookieCount + " Points";
        }
    }

    // SNAKE LOGIC
    const canvas = document.getElementById("snakeCanvas");
    const ctx = canvas.getContext("2d");
    let snake = [{x: 10, y: 10}];
    let food = {x: 15, y: 5};
    let dx = 1, dy = 0;
    let score = 0;
    let gameLoop;

    function startSnake() {
        if(gameLoop) clearInterval(gameLoop);
        snake = [{x: 10, y: 10}];
        score = 0;
        gameLoop = setInterval(drawSnake, 150);
    }

    function snakeDir(d) {
        if(d === 'up') { dx = 0; dy = -1; }
        if(d === 'down') { dx = 0; dy = 1; }
        if(d === 'left') { dx = -1; dy = 0; }
        if(d === 'right') { dx = 1; dy = 0; }
    }

    function drawSnake() {
        const head = {x: snake[0].x + dx, y: snake[0].y + dy};
        snake.unshift(head);
        
        if(head.x === food.x && head.y === food.y) {
            score++;
            document.getElementById('snakeScore').innerText = "Score: " + score;
            food = {x: Math.floor(Math.random()*15), y: Math.floor(Math.random()*10)};
        } else {
            snake.pop();
        }

        // Death Check
        if(head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 15) {
            alert("Game Over!");
            startSnake();
        }

        ctx.fillStyle = "black";
        ctx.fillRect(0,0, canvas.width, canvas.height);
        ctx.fillStyle = "lime";
        snake.forEach(p => ctx.fillRect(p.x*8, p.y*8, 7, 7));
        ctx.fillStyle = "red";
        ctx.fillRect(food.x*8, food.y*8, 7, 7);
    }
</script>

</body>
</html>
